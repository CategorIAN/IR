--(Begin 3)------------------------------------------------------------------------------------------------------------
SELECT LOAD,
       GRADUATED_IN_2024FA,
       COUNT(*) AS STUDENT_COUNT
FROM (
--(Begin 2)------------------------------------------------------------------------------------------------------------
         SELECT ID,
                GRADUATED_IN_2024FA,
                CASE
                    WHEN MAX(CASE WHEN LOAD = 'Part-Time' THEN 1 ELSE 0 END) = 1 THEN 'Part-Time'
                    ELSE 'Full-Time' END AS LOAD
         FROM (
--(Begin 1)------------------------------------------------------------------------------------------------------------
                  SELECT DISTINCT PERSON.ID,
                                  CASE
                                      WHEN (CURRENT_STATUS_DESC = 'Graduated'
                                          AND END_DATE BETWEEN
                                              GRADUATION_TERM.TERM_START_DATE AND
                                          DATEADD(WEEK, 1, GRADUATION_TERM.TERM_END_DATE)) THEN 'Yes'
                                      ELSE 'No'
                                      END                  AS GRADUATED_IN_2024FA,
                                  CASE
                                      WHEN STTR_STUDENT_LOAD IN ('F', 'O') THEN 'Full-Time'
                                      ELSE 'Part-Time' END AS LOAD
                  FROM ODS_TERMS AS GRADUATION_TERM
                      CROSS JOIN
                      Z01_PERSON AS PERSON
                           JOIN SPT_STUDENT_PROGRAMS AS SP ON PERSON.ID = SP.STPR_STUDENT
                           JOIN SPT_ACAD_PROGRAMS AS AP ON SP.STPR_ACAD_PROGRAM = AP.ACAD_PROGRAMS_ID
                           JOIN ODS_STUDENT_TERMS ON SP.STPR_STUDENT = STTR_STUDENT
                           JOIN (VALUES ('6188340'),
                                        ('6183797'),
                                        ('6181990'),
                                        ('6179934'),
                                        ('6183031'),
                                        ('6183735'),
                                        ('6166260'),
                                        ('6181992'),
                                        ('6174501'),
                                        ('6191644'),
                                        ('6176057'),
                                        ('6181856'),
                                        ('6177288'),
                                        ('6188940'),
                                        ('6178577'),
                                        ('6178578'),
                                        ('6184254'),
                                        ('6180886'),
                                        ('6191296'),
                                        ('6178218'),
                                        ('6187470'),
                                        ('6192005'),
                                        ('6176063'),
                                        ('6179201'),
                                        ('6177970'),
                                        ('6182508'),
                                        ('6178223'),
                                        ('6184940'),
                                        ('6181765'),
                                        ('6181603'),
                                        ('6165832'),
                                        ('5906903'),
                                        ('6181766'),
                                        ('6182108'),
                                        ('6051831'),
                                        ('6181767'),
                                        ('6179261'),
                                        ('6175360'),
                                        ('6179355'),
                                        ('6181859'),
                                        ('6179262'),
                                        ('6182248'),
                                        ('6183561'),
                                        ('6178496'),
                                        ('6182295'),
                                        ('6182296'),
                                        ('6182298'),
                                        ('5552821'),
                                        ('6178907'),
                                        ('6188732'),
                                        ('6178499'),
                                        ('6182413'),
                                        ('6182169'),
                                        ('6173834'),
                                        ('6191645'),
                                        ('6192119'),
                                        ('6174904'),
                                        ('6080634'),
                                        ('6173838'),
                                        ('6178594'),
                                        ('6176337'),
                                        ('6176343'),
                                        ('6177066'),
                                        ('6174382'),
                                        ('6187467'),
                                        ('6181672'),
                                        ('6176042'),
                                        ('6165895'),
                                        ('6175162'),
                                        ('6188731'),
                                        ('6029556'),
                                        ('6178745'),
                                        ('6187468'),
                                        ('6183878'),
                                        ('6173847'),
                                        ('6181551'),
                                        ('6181472'),
                                        ('6181676'),
                                        ('6170375'),
                                        ('6005076'),
                                        ('6163738'),
                                        ('6177665'),
                                        ('6192120'),
                                        ('6175466'),
                                        ('6182938'),
                                        ('6179636'),
                                        ('6181257'),
                                        ('6177339'),
                                        ('6174582'),
                                        ('6175488'),
                                        ('6181688'),
                                        ('6180311'),
                                        ('6183477'),
                                        ('6174106'),
                                        ('6178968'),
                                        ('6179299'),
                                        ('6184990'),
                                        ('6179506'),
                                        ('5949366'),
                                        ('6179507'),
                                        ('6189084'),
                                        ('6170007'),
                                        ('6174109'),
                                        ('6182111'),
                                        ('6127269'),
                                        ('6096897'),
                                        ('6178981'),
                                        ('6174283'),
                                        ('6180624'),
                                        ('6188541'),
                                        ('6175855'),
                                        ('6184281'),
                                        ('6174114'),
                                        ('6178343'),
                                        ('6179412'),
                                        ('6174920'),
                                        ('6188264'),
                                        ('6178632'),
                                        ('5890472'),
                                        ('6174623'),
                                        ('6178669'),
                                        ('6174395'),
                                        ('6174625'),
                                        ('6079363'),
                                        ('6181581'),
                                        ('6178770'),
                                        ('6179024'),
                                        ('6173998'),
                                        ('6154556'),
                                        ('6173885'),
                                        ('6174750'),
                                        ('6179426'),
                                        ('6178260'),
                                        ('6173888'),
                                        ('6181714'),
                                        ('6178533'),
                                        ('6182068'),
                                        ('5930237'),
                                        ('6179432'),
                                        ('6181496'),
                                        ('6176944'),
                                        ('6191183'),
                                        ('6140457'),
                                        ('6174754'),
                                        ('6174123'))
                      AS STUDENTS(ID) ON PERSON.ID = STUDENTS.ID
                  WHERE ACPG_TITLE IN ('Nursing', 'Accelerated Nursing')
                    AND STTR_TERM IN ('2024SU', '2024FA', '2025SP', '2025SU')
                  AND GRADUATION_TERM.TERMS_ID = '2024FA'
--(End 1)---------------------------------------------------------------------------------------------------------------
              ) AS X
         GROUP BY ID, GRADUATED_IN_2024FA
--(End 2)---------------------------------------------------------------------------------------------------------------
     ) AS X
GROUP BY LOAD, GRADUATED_IN_2024FA
--(End 3)---------------------------------------------------------------------------------------------------------------


